import{r as _,j as c,a,b as g,c as R,d as v,e as y,t as b,u as h,f as C,R as L,g as D,P as F}from"./vendor.407224ce.js";const I=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}};I();function W({onHandleCityName:e}){const[t,r]=_.exports.useState("");function n(s){r(s.target.value)}function i(s){s.preventDefault(),e(t),r("")}return c("form",{className:"weather__search",onSubmit:i,children:[a("input",{className:"search__input",value:t,onChange:n,type:"text",placeholder:"Location"}),a("input",{type:"submit",className:"search__btn",value:""})]})}const u={WEATHER_SERVER:"https://api.openweathermap.org/data/2.5/weather",API_KEY:"f660a2fb1e4bad108d6160b7f58c555f",METRIC:"&units=metric",ICONS:"https://openweathermap.org/img/wn/",FORECAST_SERVER:"https://api.openweathermap.org/data/2.5/forecast"};async function $(e){if(!e)return;const t=`${u.WEATHER_SERVER}?q=${e}&appid=${u.API_KEY}${u.METRIC}`;try{const n=await(await fetch(t)).json();if(n.name)return n;throw new Error(n.message)}catch(r){alert(`Oops: ${r.message}`)}}async function x(e){if(!e)return;const t=`${u.FORECAST_SERVER}?q=${e}&appid=${u.API_KEY}${u.METRIC}`;try{const n=await(await fetch(t)).json();if(n.list)return n;throw new Error}catch{return}}function N(e){const t=new Date(e*1e3);let r=t.getHours(),n=t.getMinutes();return n=n<10?"0"+n:n,r=r<10?"0"+r:r,`${r}:${n}`}function M(e){const t=new Date(e*1e3),r=t.toLocaleString("en",{month:"long"});return`${t.getDate()} ${r}`}const o={ADD_LOCATION:"ADD_LOCATION",REMOVE_LOCATION:"REMOVE_LOCATION",SET_CURRENT_LOCATION:"SET_CURRENT_LOCATION",ADD_WEATHER:"ADD_WEATHER",ADD_FORECAST:"ADD_FORECAST"};function k(e){return{type:o.ADD_WEATHER,weather:{name:e.name,temperature:Math.round(e.main.temp)+"\xB0",image:`${u.ICONS}${e.weather[0].icon}@4x.png`,details:{feels_like:Math.round(e.main.feels_like)+"\xB0",weather:e.weather[0].main,sunrise:N(e.sys.sunrise),sunset:N(e.sys.sunset)}}}}function j(e){return{type:o.ADD_FORECAST,forecast:e}}function B(e){return{type:o.ADD_LOCATION,location:e}}function T(e){return{type:o.REMOVE_LOCATION,location:e}}function w(e){return{type:o.SET_CURRENT_LOCATION,location:e}}const O={saveFavoriteCities(e){return localStorage.setItem("favoriteCities",JSON.stringify(Array.from(e)))},getFavoriteCities(){return JSON.parse(localStorage.getItem("favoriteCities"))||[]},saveCurrentCity(e){return localStorage.setItem("currentCity",JSON.stringify(e))},getCurrentCity(){return JSON.parse(localStorage.getItem("currentCity"))}},A={currentLocation:g.get("currentCity")?g.get("currentCity"):"Samara",locations:O.getFavoriteCities(),weather:{},forecast:{}};function E(e=[],t){switch(t.type){case o.ADD_LOCATION:return e.includes(t.location)?void 0:[...e,t.location];case o.REMOVE_LOCATION:return e.filter(r=>r!==t.location);default:return e}}function V(e=A.currentLocation,t){switch(t.type){case o.SET_CURRENT_LOCATION:return t.location;default:return e}}function H(e={},t){switch(t.type){case o.ADD_WEATHER:return t.weather;default:return e}}function P(e={},t){switch(t.type){case o.ADD_FORECAST:return t.forecast;default:return e}}function U(e=A,t){switch(t.type){case o.SET_CURRENT_LOCATION:return Object.assign({},e,{currentLocation:V(e.currentLocation,t)});case o.ADD_LOCATION:return Object.assign({},e,{locations:E(e.locations,t)});case o.REMOVE_LOCATION:return Object.assign({},e,{locations:E(e.locations,t)});case o.ADD_WEATHER:return Object.assign({},e,{weather:H(e.weather,t)});case o.ADD_FORECAST:return Object.assign({},e,{forecast:P(e.forecast,t)});default:return e}}const f=R(U,v(y(b)));function J({onHandleCityName:e}){const t=h(s=>s.locations),r=C();function n(s){const l=s.target.textContent;l!==f.getState().currentLocation&&e(l)}function i(s){r(T(s)),O.saveFavoriteCities(f.getState().locations)}return c("div",{className:"locations",children:[a("div",{className:"locations__header",children:a("p",{className:"locations__title",children:"Added locations:"})}),a("div",{className:"cities__list",children:t.length===0?null:t.map((s,l)=>c("div",{onClick:n,className:"cities__item",children:[a("p",{className:"added-city",children:s}),a("button",{onClick:()=>i(s),className:"cities__delete-btn",type:"button"})]},l))})]})}const K=e=>e.currentLocation,Y=e=>e.weather,q=e=>e.forecast,z=e=>e.locations;function G({cityInfo:e}){const[t,r]=_.exports.useState({isToggle:!1}),n=["now__btn_heart"],i=h(z),s=C();i.includes(e.name)?t.isToggle=!0:t.isToggle=!1;function l(){r({isToggle:!t.isToggle}),i.includes(e.name)?s(T(e.name)):s(B(e.name)),O.saveFavoriteCities(f.getState().locations)}return t.isToggle&&n.push("now__btn_active"),c("div",{className:"current-weather__now",children:[a("p",{className:"now__temperature tab",children:e.temperature}),a("img",{className:"now__img",src:e.image,alt:""}),c("div",{className:"now-wrapper",children:[a("p",{className:"now__city city-name",children:e.name}),a("button",{onClick:l,className:n.join(" ")})]})]})}function Q({cityInfo:e}){return c("div",{className:"current-weather__details",children:[a("p",{className:"details__city city-name",children:e.name}),c("ul",{className:"details__list",children:[c("li",{className:"details__item temp",children:["Temperature: ",e.temperature]}),c("li",{className:"details__item feels-like",children:["Feels like: ",e.details.feels_like]}),c("li",{className:"details__item details-weather",children:["Weather: ",e.details.weather]}),c("li",{className:"details__item sunrise",children:["Sunrise: ",e.details.sunrise]}),c("li",{className:"details__item sunset",children:["Sunset: ",e.details.sunset]})]})]})}function X({cityInfo:e,forecastInfo:t}){let r=[];return r=t.list,c("div",{className:"current-weather__forecast",children:[a("p",{className:"forecast__city city-name",children:e.name}),a("div",{className:"forecast__weather-timetable",children:r.map((n,i)=>c("div",{className:"forecast__weather-item",children:[a("p",{className:"weather-timetable__date",children:M(n.dt)}),a("p",{className:"weather-timetable__time",children:N(n.dt)}),c("p",{className:"weather-timetable__temp",children:["Temperature: ",Math.round(n.main.temp),"\xB0",a("br",{}),"Feels like: ",Math.round(n.main.feels_like),"\xB0"]}),c("div",{className:"weather-timetable__precipitation",children:[a("p",{className:"precipitation__title",children:n.weather[0].main}),a("img",{className:"precipitation__img",src:`${u.ICONS}${n.weather[0].icon}@4x.png`,alt:"precipitation_icon"})]})]},i))})]})}const S=L.createContext();function p({name:e}){const{button:t,setButton:r}=_.exports.useContext(S),n=new Set;n.add("tabs__item-btn");function i(s){r(s.target.textContent)}return t===e?n.add("active"):n.delete("active"),a("button",{onClick:i,className:Array.from(n).join(" "),type:"button",children:e})}const d={NOW:"Now",DETAILS:"Details",FORECAST:"Forecast"};function Z(){return a("div",{className:"tabs",children:c("ul",{className:"tabs__list",children:[a("li",{className:"tabs__item",children:a(p,{name:d.NOW})}),a("li",{className:"tabs__item",children:a(p,{name:d.DETAILS})}),a("li",{className:"tabs__item",children:a(p,{name:d.FORECAST})})]})})}function ee({pressedButton:e,cityInfo:t,forecastInfo:r}){switch(e){case d.NOW:return a(G,{cityInfo:t});case d.DETAILS:return a(Q,{cityInfo:t});case d.FORECAST:return a(X,{cityInfo:t,forecastInfo:r});default:return null}}function te(e){return function(t){$(e).then(r=>{if(!r)return t(w("Samara"));t(k(r))})}}function re(e){return function(t){x(e).then(r=>{!r||t(j(r))})}}function ne(){const[e,t]=_.exports.useState("Now");_.exports.useEffect(async()=>{await l(n)},[]);const r=C(),n=h(K),i=h(Y),s=h(q);async function l(m){!m||(r(w(m)),r(te(m)),r(re(m)),g.set("currentCity",m,{expires:1/24}))}return c("div",{className:"weather",children:[a(W,{onHandleCityName:l}),c("div",{className:"container",children:[c("div",{className:"current-weather",children:[a(ee,{pressedButton:e,cityInfo:i,forecastInfo:s}),a(S.Provider,{value:{button:e,setButton:t},children:a(Z,{})})]}),a(J,{onHandleCityName:l})]})]})}D.render(a(F,{store:f,children:a(ne,{})}),document.getElementById("root"));
